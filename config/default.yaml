# Drone Platform Configuration
# Copy to /etc/drone/config.yaml and modify for your setup

drone:
  # Identity directory (generated by 'drone-cli provision')
  # Default uses ~/.drone/identity (no root required)
  # For production, use /etc/drone/identity with proper permissions
  identity_dir: "~/.drone/identity"
  org_id: "zypher-prototype"

flight:
  # MAVLink connection string
  # Serial: /dev/ttyTHS1 (Jetson UART) or /dev/ttyACM0 (USB)
  # SITL:   udp:127.0.0.1:14550
  connection: "udp:127.0.0.1:14550"
  baud_rate: 57600
  # Safety limits
  max_altitude_m: 50.0
  max_speed_ms: 10.0
  rtl_battery_pct: 25
  # Timeout for heartbeat before failsafe (seconds)
  heartbeat_timeout_s: 5

vision:
  # Camera source
  # CSI: "nvarguscamerasrc ! video/x-raw(memory:NVMM),width=1280,height=720,framerate=30/1 ! nvvidconv ! video/x-raw,format=BGRx ! videoconvert ! video/x-raw,format=BGR ! appsink"
  # USB: 0 (device index)
  # File: "/path/to/video.mp4" (for testing)
  camera_source: 0
  frame_width: 1280
  frame_height: 720
  fps: 30
  # Detection model
  model: "yolov8n"  # yolov8n, yolov8s, or path to custom .pt/.onnx
  confidence_threshold: 0.5
  # Classes to detect (COCO class names)
  target_classes:
    - "person"
    - "car"
    - "truck"
    - "bicycle"
  # Save detection frames
  save_detections: true
  detections_dir: "~/.drone/detections"

security:
  # Ed25519 key files (inside identity_dir)
  private_key_file: "drone_key.pem"
  public_key_file: "drone_key_pub.pem"
  # Audit log
  audit_log_db: "~/.drone/audit.db"
  # Command replay window (seconds)
  command_max_age_s: 30

comms:
  mqtt:
    broker: "localhost"
    port: 1883
    # Topic prefix: alerts published to {prefix}/alerts/{drone_id}
    topic_prefix: "drone"
    # Use TLS (set cert paths if true)
    use_tls: false
    # QoS: 0=at most once, 1=at least once, 2=exactly once
    qos: 1

data:
  # Local mission database
  db_path: "~/.drone/missions.db"
  # Max storage before oldest findings get pruned (MB)
  max_storage_mb: 4096

surveillance:
  # Patrol behavior
  loop_patrol: true
  # Hover time at each waypoint (seconds)
  waypoint_hover_s: 5
  # How long to loiter on detection (seconds)
  detection_loiter_s: 10
  # Min seconds between alerts for same location
  alert_cooldown_s: 30
  # Default patrol altitude
  default_altitude_m: 30.0
  default_speed_ms: 5.0
